# Enhanced Markdown Guide

This guide explains how to use RAG-Anything's enhanced markdown generation features for multimodal content.

## Overview

Enhanced markdown generation allows you to create structured markdown documents that include images, tables, equations, and metadata in a standardized format.

## Basic Usage

### Generate Enhanced Markdown

```python
from raganything.enhanced_markdown import generate_enhanced_markdown

content = "# Document Title\n\nMain content here."

metadata = {
    "author": "John Doe",
    "date": "2025-01-01",
}

images = [
    {
        "content": "path/to/image.jpg",
        "metadata": {"path": "path/to/image.jpg", "size": 102400},
    },
]

tables = [
    {
        "content": "| Col1 | Col2 |\n|------|------|\n| A | B |",
        "metadata": {"rows": 1},
    },
]

equations = [
    {
        "content": "E = mc^2",
        "format": "latex",
    },
]

markdown = generate_enhanced_markdown(
    content=content,
    metadata=metadata,
    images=images,
    tables=tables,
    equations=equations,
    include_metadata=True,
)
```

## Using EnhancedMarkdownGenerator

### Class-based Approach

```python
from raganything.enhanced_markdown import EnhancedMarkdownGenerator

generator = EnhancedMarkdownGenerator(include_metadata=True)

markdown = generator.generate(
    content=content,
    metadata=metadata,
    images=images,
    tables=tables,
    equations=equations,
)
```

### Adding Elements Individually

```python
# Start with base content
markdown = "# My Document\n\nSome content."

# Add image
markdown = generator.add_image_reference(
    markdown,
    "image.jpg",
    alt_text="Example Image",
)

# Add table
markdown = generator.add_table(
    markdown,
    "| Col1 | Col2 |\n|------|------|\n| A | B |",
    caption="Sample Table",
)

# Add equation
markdown = generator.add_equation(
    markdown,
    "x^2 + y^2 = r^2",
    format="latex",
)
```

## Image Handling

### Image References

```python
# Add image reference
markdown = generator.add_image_reference(
    markdown,
    image_path="path/to/image.jpg",
    alt_text="Description",
    position=None,  # None = append, or specify line number
)
```

### Base64 Encoded Images

Images can be embedded as base64:

```python
images = [
    {
        "content": "data:image/png;base64,iVBORw0KG...",  # Base64 string
        "metadata": {"size": 102400},
    },
]
```

## Table Formatting

Tables are formatted as standard markdown tables:

```python
tables = [
    {
        "content": """| Name | Age | City |
|------|-----|------|
| Alice | 30 | New York |
| Bob | 25 | London |""",
        "metadata": {"rows": 2},
    },
]
```

## Equation Formatting

### LaTeX Equations

```python
equations = [
    {
        "content": "E = mc^2",
        "format": "latex",
    },
    {
        "content": "\\int_0^\\infty e^{-x^2} dx = \\frac{\\sqrt{\\pi}}{2}",
        "format": "latex",
    },
]
```

### Other Formats

```python
equations = [
    {
        "content": "<math>...</math>",
        "format": "mathml",
    },
]
```

## Metadata

Metadata is included at the top of the document:

```python
metadata = {
    "author": "John Doe",
    "date": "2025-01-01",
    "version": "1.0",
    "tags": ["research", "paper"],
}
```

## Integration with Parsers

Enhanced markdown is automatically generated by parsers:

```python
from raganything import RAGAnything

rag = RAGAnything()
result = rag.process_document("document.pdf")

# Result includes markdown content
markdown_content = result["content"]
```

## Example

See `examples/enhanced_markdown_example.py` for a complete example.

